<html>
    <head>

    </head>
    <body>
        <script src="ffl_wasm.js"></script>

        <canvas></canvas>

        <script>
            const canvas = document.querySelector("canvas");

            fetch("AFLResHigh_2_3.dat")
                .then(_ => _.arrayBuffer())
                .then(data => {
                    // expose to context for debugging purpose (this is disgusting)
                    let context = Module.GL.createContext(canvas, {
                        majorVersion: 1
                    });
                    Module.GL.makeContextCurrent(context);
                    window.d = data

                    let address = Module.ccall("initBuffer", ["number"], ["number"], [data.byteLength]);
                    console.log(address, data.byteLength);
                    Module.HEAP8.set(new Uint8Array(data), address);
                    console.log(Module.ccall("init", ["boolean"], null));
                    console.log(Module.ccall("test", ["boolean"]));

                })
        </script>
    </body>
</html>